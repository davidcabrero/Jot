using System;
using System.Collections.Generic;
using System.ComponentModel;

namespace Jot.Services
{
    public class LocalizationService : INotifyPropertyChanged
    {
        private static LocalizationService _instance;
        private Dictionary<string, Dictionary<string, string>> _localizedStrings;

        public static LocalizationService Instance => _instance ??= new LocalizationService();

        public event PropertyChangedEventHandler PropertyChanged;

        private readonly Dictionary<string, string> _supportedLanguages = new()
        {
            { "en", "English" },
            { "es", "Espa√±ol" },
            { "ca", "Catal√†" },
            { "ast", "Asturianu" }
        };

        public Dictionary<string, string> SupportedLanguages => _supportedLanguages;

        private string _currentLanguage = "en";
        public string CurrentLanguage 
        { 
            get => _currentLanguage;
            private set
            {
                _currentLanguage = value;
                PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(nameof(CurrentLanguage)));
                PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(nameof(CurrentLanguageName)));
            }
        }

        public string CurrentLanguageName => _supportedLanguages.TryGetValue(CurrentLanguage, out var name) ? name : "English";

        private LocalizationService()
        {
            InitializeLocalizedStrings();

            // Establecer idioma inicial (ingl√©s por defecto)
            CurrentLanguage = "en";
        }

        private void InitializeLocalizedStrings()
        {
            _localizedStrings = new Dictionary<string, Dictionary<string, string>>
            {
                ["en"] = new Dictionary<string, string>
                {
                    ["AppTitle"] = "Jot - Modern Note Taking",
                    ["Documents"] = "Documents",
                    ["NewDocument"] = "New Document",
                    ["SaveDocument"] = "Save Document",
                    ["DeleteDocument"] = "Delete Document",
                    ["ExportToHtml"] = "Export to HTML",
                    ["UploadToGitHub"] = "Upload to GitHub",
                    ["Search"] = "Search",
                    ["Language"] = "Language",
                    ["EditMode"] = "Edit",
                    ["PreviewMode"] = "Preview",
                    ["SplitMode"] = "Split",
                    ["VoiceRecognition"] = "Voice Recognition",
                    ["Listening"] = "üé§ Listening... Speak now",
                    ["VoiceRecognitionStopped"] = "üîá Voice recognition stopped",
                    ["ReadingText"] = "üîä Reading Text",
                    ["PlayingTextAloud"] = "Playing text aloud...",
                    ["Cancel"] = "Cancel",
                    ["Stop"] = "Stop",
                    ["OK"] = "OK",
                    ["FocusModeActivated"] = "üéØ Focus Mode Activated",
                    ["FocusModeDeactivated"] = "üéØ Focus Mode Deactivated",
                    ["FocusModeDescription"] = "Simplified interface for concentration.\nPress F11 to exit.",
                    ["FocusModeRestored"] = "Complete interface restored.",
                    ["FontSize"] = "üìè Font Size",
                    ["CurrentSize"] = "Current size: {0}pt",
                    ["PomodoroCompleted"] = "üçÖ Pomodoro Completed!",
                    ["PomodoroCompletedDescription"] = "Great job! You've completed a 25-minute focus session.\n\nTime for a 5-minute break?",
                    ["StartBreak"] = "Start Break",
                    ["ContinueWriting"] = "Continue Writing",
                    ["Close"] = "Close",
                    ["Warning"] = "Warning",
                    ["Success"] = "Success",
                    ["Error"] = "Error",
                    ["NoDocumentSelected"] = "Please select a document first.",
                    ["AdvancedSearch"] = "Advanced Search",
                    ["SearchFor"] = "Search for:",
                    ["SearchIn"] = "Search in:",
                    ["CurrentDocument"] = "Current Document",
                    ["AllDocuments"] = "All Documents",
                    ["SelectedDocuments"] = "Selected Documents",
                    ["UseRegularExpressions"] = "Use regular expressions",
                    ["WholeWordsOnly"] = "Whole words only",
                    ["FindAndReplace"] = "Find and Replace",
                    ["Find"] = "Find:",
                    ["ReplaceWith"] = "Replace with:",
                    ["CaseSensitive"] = "Case sensitive",
                    ["ReplaceAll"] = "Replace All",
                    ["FindNext"] = "Find Next",
                    ["SearchResult"] = "üîç Search Result",
                    ["FoundAtPosition"] = "Found at position {0}",
                    ["NotFound"] = "'{0}' not found",
                    ["ReplacementsCompleted"] = "{0} replacements completed",
                    ["DocumentStatistics"] = "üìä Document Statistics",
                    ["CompleteStatistics"] = "üìä Complete Statistics",
                    ["Content"] = "üìù Content:",
                    ["Words"] = "‚Ä¢ Words: {0:N0}",
                    ["Characters"] = "‚Ä¢ Characters: {0:N0}",
                    ["CharactersNoSpaces"] = "‚Ä¢ Characters (no spaces): {0:N0}",
                    ["Lines"] = "‚Ä¢ Lines: {0:N0}",
                    ["Paragraphs"] = "‚Ä¢ Paragraphs: {0:N0}",
                    ["Sentences"] = "‚Ä¢ Sentences: {0:N0}",
                    ["AvgWordsPerSentence"] = "‚Ä¢ Average words/sentence: {0}",
                    ["EstimatedTime"] = "‚è±Ô∏è Estimated Time:",
                    ["ReadingTime"] = "‚Ä¢ Reading time: ~{0} min",
                    ["SpeakingTime"] = "‚Ä¢ Speaking time: ~{0} min",
                    ["SessionStats"] = "üìà Session Stats:",
                    ["WordsWrittenToday"] = "‚Ä¢ Words written today: {0:N0}",
                    ["WordsInSession"] = "‚Ä¢ Words in session: {0:N0}",
                    ["NoDocumentSelected"] = "No Document Selected",
                    ["NoDocumentSelectedDescription"] = "Please select or create a document first before uploading to GitHub.",
                    ["Connected"] = "Connected",
                    ["NotConnected"] = "Not Connected",
                    ["LanguageChanged"] = "Language changed to {0}",
                    ["LastModified"] = "Last modified",
                    ["DocumentIndex"] = "Document Index",
                    ["WelcomeToJot"] = "Welcome to Jot",
                    ["CreateFirstDocument"] = "Create your first document to get started",
                    ["CreateNewDocument"] = "Create New Document",
                    ["GitHub"] = "GitHub",
                    ["ConnectGitHub"] = "Connect GitHub",
                    ["UploadCurrent"] = "Upload Current",
                    ["Repositories"] = "Repositories",
                    ["Disconnect"] = "Disconnect",
                    ["ExpandGitHubOptions"] = "Expand GitHub Options",
                    ["DocumentTitle"] = "Document title...",
                    ["SearchDocuments"] = "Search documents...",
                    ["WordsCount"] = "Words: {0}",
                    ["CharactersCount"] = "Characters: {0}",
                    ["ReadingTimeCount"] = "Reading time: {0} min",
                    ["LineColumn"] = "Line {0}, Column {1}",
                    ["ExportingToHtml"] = "Exporting to HTML...",
                    ["ToggleSidebar"] = "Toggle Sidebar",
                    ["QuickUploadToGitHub"] = "Quick Upload to GitHub",
                    ["GitHubSettings"] = "GitHub Settings",
                    ["AIAssistant"] = "AI Assistant",
                    ["PythonCodeExecution"] = "Python Code Execution",
                    ["Close"] = "Close",
                    ["Send"] = "Send",
                    ["EnterYourQuestion"] = "Enter your question...",
                    ["SuggestedQuestions"] = "Suggested questions:",
                    ["ExportDocument"] = "Export to HTML",
                    ["DeleteDocument"] = "Delete",
                    ["UploadDocument"] = "Upload to GitHub",
                    ["ChatbotWelcome"] = "Hi! I'm your document assistant. You can ask me about the content of your documents.",
                    ["SendEmail"] = "Send by Email",
                    ["Send"] = "Send",
                    ["Cancel"] = "Cancel",
                    ["ToEmail"] = "To (Email)",
                    ["FromEmail"] = "From (Email)",
                    ["SendMethod"] = "Send Method",
                    ["DefaultEmailClient"] = "Default Email Client",
                    ["CustomSMTP"] = "Custom SMTP",
                    ["EmailFormat"] = "Format",
                    ["PlainText"] = "Plain Text",
                    ["Password"] = "Password",
                    ["SMTPServer"] = "SMTP Server",
                    ["EmailWarning"] = "For Gmail/Outlook, you may need to enable 'Less secure app access' or use an app password.",
                    ["EmailSentSuccess"] = "Email sent successfully!",
                    ["EmailSentError"] = "Error sending email. Please check your configuration.",
                    ["EnterEmail"] = "Please enter a valid email address.",
                    ["EmailClientOpened"] = "Email client opened successfully. Please complete sending from your email application.",
                    ["EnterCredentials"] = "Please enter your email credentials (email and password).",
                    ["PrintDocument"] = "Print Document",
                    ["PrintError"] = "Error printing document. Please try again.",

                    // üîÑ Version History
                    ["VersionHistory"] = "Version History",
                    ["Versions"] = "Versions",
                    ["Restore"] = "Restore",
                    ["Details"] = "Details",
                    ["Preview"] = "Preview",
                    ["CurrentVersion"] = "Current version",

                    // üîê Encryption
                    ["EncryptDocument"] = "Encrypt Document",
                    ["UnlockDocument"] = "Unlock Document",
                    ["ChangePassword"] = "Change Password",
                    ["Encrypt"] = "Encrypt",
                    ["Unlock"] = "Unlock",
                    ["Change"] = "Change",
                    ["CurrentPassword"] = "Current Password",
                    ["NewPassword"] = "New Password",
                    ["ConfirmPassword"] = "Confirm Password",
                    ["PasswordsDoNotMatch"] = "Passwords do not match",
                    ["EncryptDescription"] = "Protect your document with a strong password. Use AES-256 encryption.",
                    ["UnlockDescription"] = "Enter your password to unlock and view this document.",
                    ["ChangePasswordDescription"] = "Change the encryption password for this document.",
                    ["EncryptionWarning"] = "‚ö†Ô∏è Remember your password! There is no way to recover it if you forget it.",
                    ["EncryptionError"] = "Encryption error. Check your password and try again.",
                    ["LockDocument"] = "Lock Document",

                    // ‚òÅÔ∏è Cloud Sync
                    ["CloudSync"] = "Cloud Sync",
                    ["CloudProvider"] = "Cloud Provider",
                    ["AutoSync"] = "Auto Sync",
                    ["Enabled"] = "Enabled",
                    ["Disabled"] = "Disabled",
                    ["LastSync"] = "Last sync",
                    ["NeverSynced"] = "Never synced",
                    ["SyncNow"] = "Sync Now",
                    ["Syncing"] = "Syncing...",
                    ["SelectProvider"] = "Select a cloud provider",
                    ["SyncSuccess"] = "Synced successfully",
                    ["SyncError"] = "Sync error",
                    ["CloudSyncInfo"] = "Your document will be synchronized automatically with the selected cloud provider.",

                    // üì∏ OCR
                    ["OCR"] = "OCR - Text Recognition",
                    ["OCRDescription"] = "Extract text from images using optical character recognition.",
                    ["OCRLanguage"] = "OCR Language",
                    ["SelectImage"] = "Select Image",
                    ["FromClipboard"] = "From Clipboard",
                    ["ExtractedText"] = "Extracted Text",
                    ["NoTextExtracted"] = "No text extracted yet...",
                    ["ExtractingText"] = "Extracting text...",
                    ["TextExtracted"] = "Text extracted successfully",
                    ["NoImageInClipboard"] = "No image in clipboard",
                    ["NoTextFound"] = "No text found in image",
                    ["InsertText"] = "Insert Text",
                    ["Characters"] = "characters",

                    // üîó Document Links
                    ["DocumentLinks"] = "Document Links",
                    ["OutgoingLinks"] = "Outgoing Links",
                    ["Backlinks"] = "Backlinks",
                    ["RelatedDocuments"] = "Related Documents",
                    ["BrokenLinks"] = "Broken Links",
                    ["WikiLinkHelp"] = "Use [[Document Name]] to create links between documents",
                    ["NoLinksFound"] = "No links found",
                    ["NoBacklinksFound"] = "No backlinks found",
                    ["NoRelatedFound"] = "No related documents found",
                    ["DocumentNotFound"] = "Document not found",
                    ["NoBrokenLinks"] = "No broken links",

                    // üìé Attachments
                    ["Attachments"] = "Attachments",
                    ["AddFile"] = "Add File",
                    ["PasteImage"] = "Paste Image",
                    ["SelectAttachment"] = "Select an attachment to preview",
                    ["NoAttachments"] = "No attachments yet",
                    ["OpenFile"] = "Open File",

                    // üîß Tooltips
                    ["TooltipNewDocument"] = "New Document",
                    ["TooltipSave"] = "Save",
                    ["TooltipExportHTML"] = "Export to HTML",
                    ["TooltipPrint"] = "Print Document",
                    ["TooltipPython"] = "Python Code Execution",
                    ["TooltipGitHubUpload"] = "Quick Upload to GitHub",
                    ["TooltipGitHubSettings"] = "GitHub Settings",
                    ["TooltipLanguage"] = "Language / Idioma",
                    ["TooltipAIAssistant"] = "AI Assistant",
                    ["TooltipSendEmail"] = "Send by Email",
                    ["TooltipVersionHistory"] = "Version History",
                    ["TooltipEncryption"] = "Encryption",
                    ["TooltipCloudSync"] = "Cloud Sync",
                    ["TooltipOCR"] = "OCR - Text Recognition",
                    ["TooltipDocumentLinks"] = "Document Links",
                    ["TooltipAttachments"] = "Attachments"
                },
                ["es"] = new Dictionary<string, string>
                {
                    ["AppTitle"] = "Jot - Toma de Notas Moderna",
                    ["Documents"] = "Documentos",
                    ["NewDocument"] = "Nuevo Documento",
                    ["SaveDocument"] = "Guardar Documento",
                    ["DeleteDocument"] = "Eliminar Documento",
                    ["ExportToHtml"] = "Exportar a HTML",
                    ["UploadToGitHub"] = "Subir a GitHub",
                    ["Search"] = "Buscar",
                    ["Language"] = "Idioma",
                    ["EditMode"] = "Editar",
                    ["PreviewMode"] = "Vista Previa",
                    ["SplitMode"] = "Dividir",
                    ["VoiceRecognition"] = "Reconocimiento de Voz",
                    ["Listening"] = "üé§ Escuchando... Habla ahora",
                    ["VoiceRecognitionStopped"] = "üîá Reconocimiento de voz detenido",
                    ["ReadingText"] = "üîä Leyendo Texto",
                    ["PlayingTextAloud"] = "Reproduciendo texto en voz alta...",
                    ["Cancel"] = "Cancelar",
                    ["Stop"] = "Detener",
                    ["OK"] = "Aceptar",
                    ["FocusModeActivated"] = "üéØ Modo Enfoque Activado",
                    ["FocusModeDeactivated"] = "üéØ Modo Enfoque Desactivado",
                    ["FocusModeDescription"] = "Interfaz simplificada para concentraci√≥n.\nPresiona F11 para salir.",
                    ["FocusModeRestored"] = "Interfaz completa restaurada.",
                    ["Warning"] = "Advertencia",
                    ["Success"] = "√âxito",
                    ["Error"] = "Error",
                    ["NoDocumentSelected"] = "Por favor selecciona un documento primero.",
                    ["FontSize"] = "üìè Tama√±o de Fuente",
                    ["CurrentSize"] = "Tama√±o actual: {0}pt",
                    ["PomodoroCompleted"] = "üçÖ ¬°Pomodoro Completado!",
                    ["PomodoroCompletedDescription"] = "¬°Buen trabajo! Has completado una sesi√≥n de concentraci√≥n de 25 minutos.\n\n¬øEs hora de un descanso de 5 minutos?",
                    ["StartBreak"] = "Iniciar Descanso",
                    ["ContinueWriting"] = "Continuar Escribiendo",
                    ["Close"] = "Cerrar",
                    ["AdvancedSearch"] = "B√∫squeda Avanzada",
                    ["SearchFor"] = "Buscar:",
                    ["SearchIn"] = "Buscar en:",
                    ["CurrentDocument"] = "Documento Actual",
                    ["AllDocuments"] = "Todos los Documentos",
                    ["SelectedDocuments"] = "Documentos Seleccionados",
                    ["UseRegularExpressions"] = "Usar expresiones regulares",
                    ["WholeWordsOnly"] = "Solo palabras completas",
                    ["FindAndReplace"] = "Buscar y Reemplazar",
                    ["Find"] = "Buscar:",
                    ["ReplaceWith"] = "Reemplazar con:",
                    ["CaseSensitive"] = "Distinguir may√∫sculas y min√∫sculas",
                    ["ReplaceAll"] = "Reemplazar Todo",
                    ["FindNext"] = "Buscar Siguiente",
                    ["SearchResult"] = "üîç Resultado de B√∫squeda",
                    ["FoundAtPosition"] = "Encontrado en posici√≥n {0}",
                    ["NotFound"] = "'{0}' no encontrado",
                    ["ReplacementsCompleted"] = "Se realizaron {0} reemplazos",
                    ["DocumentStatistics"] = "üìä Estad√≠sticas del Documento",
                    ["CompleteStatistics"] = "üìä Estad√≠sticas Completas",
                    ["Content"] = "üìù Contenido:",
                    ["Words"] = "‚Ä¢ Palabras: {0:N0}",
                    ["Characters"] = "‚Ä¢ Caracteres: {0:N0}",
                    ["CharactersNoSpaces"] = "‚Ä¢ Caracteres (sin espacios): {0:N0}",
                    ["Lines"] = "‚Ä¢ L√≠neas: {0:N0}",
                    ["Paragraphs"] = "‚Ä¢ P√°rrafos: {0:N0}",
                    ["Sentences"] = "‚Ä¢ Oraciones: {0:N0}",
                    ["AvgWordsPerSentence"] = "‚Ä¢ Promedio palabras/oraci√≥n: {0}",
                    ["EstimatedTime"] = "‚è±Ô∏è Tiempo Estimado:",
                    ["ReadingTime"] = "‚Ä¢ Tiempo de lectura: ~{0} min",
                    ["SpeakingTime"] = "‚Ä¢ Tiempo de oratoria: ~{0} min",
                    ["SessionStats"] = "üìà Estad√≠sticas de Sesi√≥n:",
                    ["WordsWrittenToday"] = "‚Ä¢ Palabras escritas hoy: {0:N0}",
                    ["WordsInSession"] = "‚Ä¢ Palabras en esta sesi√≥n: {0:N0}",
                    ["NoDocumentSelected"] = "Ning√∫n Documento Seleccionado",
                    ["NoDocumentSelectedDescription"] = "Por favor selecciona o crea un documento antes de subirlo a GitHub.",
                    ["Connected"] = "Conectado",
                    ["NotConnected"] = "No Conectado",
                    ["LanguageChanged"] = "Idioma cambiado a {0}",
                    ["LastModified"] = "√öltima modificaci√≥n",
                    ["DocumentIndex"] = "√çndice del Documento",
                    ["WelcomeToJot"] = "Bienvenido a Jot",
                    ["CreateFirstDocument"] = "Crea tu primer documento para comenzar",
                    ["CreateNewDocument"] = "Crear Nuevo Documento",
                    ["GitHub"] = "GitHub",
                    ["ConnectGitHub"] = "Conectar GitHub",
                    ["UploadCurrent"] = "Subir Actual",
                    ["Repositories"] = "Repositorios",
                    ["Disconnect"] = "Desconectar",
                    ["ExpandGitHubOptions"] = "Expandir Opciones de GitHub",
                    ["DocumentTitle"] = "T√≠tulo del documento...",
                    ["SearchDocuments"] = "Buscar documentos...",
                    ["WordsCount"] = "Palabras: {0}",
                    ["CharactersCount"] = "Caracteres: {0}",
                    ["ReadingTimeCount"] = "Tiempo de lectura: {0} min",
                    ["LineColumn"] = "L√≠nea {0}, Columna {1}",
                    ["ExportingToHtml"] = "Exportando a HTML...",
                    ["ToggleSidebar"] = "Alternar Barra Lateral",
                    ["QuickUploadToGitHub"] = "Subida R√°pida a GitHub",
                    ["GitHubSettings"] = "Configuraci√≥n de GitHub",
                    ["AIAssistant"] = "Asistente IA",
                    ["PythonCodeExecution"] = "Ejecuci√≥n de C√≥digo Python",
                    ["Close"] = "Cerrar",
                    ["Send"] = "Enviar",
                    ["EnterYourQuestion"] = "Escribe tu pregunta...",
                    ["SuggestedQuestions"] = "Preguntas sugeridas:",
                    ["ExportDocument"] = "Exportar a HTML",
                    ["DeleteDocument"] = "Eliminar",
                    ["UploadDocument"] = "Subir a GitHub",
                    ["ChatbotWelcome"] = "¬°Hola! Soy tu asistente de documentos. Puedes preguntarme sobre el contenido de tus documentos.",
                    ["SendEmail"] = "Enviar por Correo",
                    ["Send"] = "Enviar",
                    ["Cancel"] = "Cancelar",
                    ["ToEmail"] = "Para (Email)",
                    ["FromEmail"] = "De (Email)",
                    ["SendMethod"] = "M√©todo de Env√≠o",
                    ["DefaultEmailClient"] = "Cliente de Correo Predeterminado",
                    ["CustomSMTP"] = "SMTP Personalizado",
                    ["EmailFormat"] = "Formato",
                    ["PlainText"] = "Texto Plano",
                    ["Password"] = "Contrase√±a",
                    ["SMTPServer"] = "Servidor SMTP",
                    ["EmailWarning"] = "Para Gmail/Outlook, puede que necesites activar 'Acceso de apps menos seguras' o usar una contrase√±a de aplicaci√≥n.",
                    ["EmailSentSuccess"] = "¬°Email enviado correctamente!",
                    ["EmailSentError"] = "Error al enviar email. Por favor verifica tu configuraci√≥n.",
                    ["EnterEmail"] = "Por favor introduce una direcci√≥n de email v√°lida.",
                    ["EmailClientOpened"] = "Cliente de correo abierto correctamente. Por favor completa el env√≠o desde tu aplicaci√≥n de correo.",
                    ["EnterCredentials"] = "Por favor introduce tus credenciales de email (correo y contrase√±a).",
                    ["PrintDocument"] = "Imprimir Documento",
                    ["PrintError"] = "Error al imprimir el documento. Por favor intenta de nuevo.",

                    // üîÑ Historial de Versiones
                    ["VersionHistory"] = "Historial de Versiones",
                    ["Versions"] = "Versiones",
                    ["Restore"] = "Restaurar",
                    ["Details"] = "Detalles",
                    ["Preview"] = "Vista Previa",
                    ["CurrentVersion"] = "Versi√≥n actual",

                    // üîê Cifrado
                    ["EncryptDocument"] = "Cifrar Documento",
                    ["UnlockDocument"] = "Desbloquear Documento",
                    ["ChangePassword"] = "Cambiar Contrase√±a",
                    ["Encrypt"] = "Cifrar",
                    ["Unlock"] = "Desbloquear",
                    ["Change"] = "Cambiar",
                    ["CurrentPassword"] = "Contrase√±a Actual",
                    ["NewPassword"] = "Nueva Contrase√±a",
                    ["ConfirmPassword"] = "Confirmar Contrase√±a",
                    ["PasswordsDoNotMatch"] = "Las contrase√±as no coinciden",
                    ["EncryptDescription"] = "Protege tu documento con una contrase√±a segura. Usa cifrado AES-256.",
                    ["UnlockDescription"] = "Introduce tu contrase√±a para desbloquear y ver este documento.",
                    ["ChangePasswordDescription"] = "Cambia la contrase√±a de cifrado de este documento.",
                    ["EncryptionWarning"] = "‚ö†Ô∏è ¬°Recuerda tu contrase√±a! No hay forma de recuperarla si la olvidas.",
                    ["EncryptionError"] = "Error de cifrado. Verifica tu contrase√±a e intenta de nuevo.",
                    ["LockDocument"] = "Bloquear Documento",

                    // ‚òÅÔ∏è Sincronizaci√≥n
                    ["CloudSync"] = "Sincronizaci√≥n en la Nube",
                    ["CloudProvider"] = "Proveedor de Nube",
                    ["AutoSync"] = "Sincronizaci√≥n Autom√°tica",
                    ["Enabled"] = "Habilitado",
                    ["Disabled"] = "Deshabilitado",
                    ["LastSync"] = "√öltima sincronizaci√≥n",
                    ["NeverSynced"] = "Nunca sincronizado",
                    ["SyncNow"] = "Sincronizar Ahora",
                    ["Syncing"] = "Sincronizando...",
                    ["SelectProvider"] = "Selecciona un proveedor de nube",
                    ["SyncSuccess"] = "Sincronizado correctamente",
                    ["SyncError"] = "Error de sincronizaci√≥n",
                    ["CloudSyncInfo"] = "Tu documento se sincronizar√° autom√°ticamente con el proveedor de nube seleccionado.",

                    // üì∏ OCR
                    ["OCR"] = "OCR - Reconocimiento de Texto",
                    ["OCRDescription"] = "Extrae texto de im√°genes usando reconocimiento √≥ptico de caracteres.",
                    ["OCRLanguage"] = "Idioma OCR",
                    ["SelectImage"] = "Seleccionar Imagen",
                    ["FromClipboard"] = "Desde Portapapeles",
                    ["ExtractedText"] = "Texto Extra√≠do",
                    ["NoTextExtracted"] = "A√∫n no se ha extra√≠do texto...",
                    ["ExtractingText"] = "Extrayendo texto...",
                    ["TextExtracted"] = "Texto extra√≠do correctamente",
                    ["NoImageInClipboard"] = "No hay imagen en el portapapeles",
                    ["NoTextFound"] = "No se encontr√≥ texto en la imagen",
                    ["InsertText"] = "Insertar Texto",
                    ["Characters"] = "caracteres",

                    // üîó Enlaces
                    ["DocumentLinks"] = "Enlaces del Documento",
                    ["OutgoingLinks"] = "Enlaces Salientes",
                    ["Backlinks"] = "Retroenlaces",
                    ["RelatedDocuments"] = "Documentos Relacionados",
                    ["BrokenLinks"] = "Enlaces Rotos",
                    ["WikiLinkHelp"] = "Usa [[Nombre Documento]] para crear enlaces entre documentos",
                    ["NoLinksFound"] = "No se encontraron enlaces",
                    ["NoBacklinksFound"] = "No se encontraron retroenlaces",
                    ["NoRelatedFound"] = "No se encontraron documentos relacionados",
                    ["DocumentNotFound"] = "Documento no encontrado",
                    ["NoBrokenLinks"] = "No hay enlaces rotos",

                    // üìé Adjuntos
                    ["Attachments"] = "Archivos Adjuntos",
                    ["AddFile"] = "Agregar Archivo",
                    ["PasteImage"] = "Pegar Imagen",
                    ["SelectAttachment"] = "Selecciona un adjunto para previsualizar",
                    ["NoAttachments"] = "A√∫n no hay adjuntos",
                    ["OpenFile"] = "Abrir Archivo",

                    // üîß Tooltips
                    ["TooltipNewDocument"] = "Nuevo Documento",
                    ["TooltipSave"] = "Guardar",
                    ["TooltipExportHTML"] = "Exportar a HTML",
                    ["TooltipPrint"] = "Imprimir Documento",
                    ["TooltipPython"] = "Ejecuci√≥n de C√≥digo Python",
                    ["TooltipGitHubUpload"] = "Subida R√°pida a GitHub",
                    ["TooltipGitHubSettings"] = "Configuraci√≥n de GitHub",
                    ["TooltipLanguage"] = "Idioma / Language",
                    ["TooltipAIAssistant"] = "Asistente IA",
                    ["TooltipSendEmail"] = "Enviar por Correo",
                    ["TooltipVersionHistory"] = "Historial de Versiones",
                    ["TooltipEncryption"] = "Cifrado",
                    ["TooltipCloudSync"] = "Sincronizaci√≥n en la Nube",
                    ["TooltipOCR"] = "OCR - Reconocimiento de Texto",
                    ["TooltipDocumentLinks"] = "Enlaces del Documento",
                    ["TooltipAttachments"] = "Archivos Adjuntos"
                },
                ["ca"] = new Dictionary<string, string>
                {
                    ["AppTitle"] = "Jot - Presa de Notes Moderna",
                    ["Documents"] = "Documents",
                    ["NewDocument"] = "Nou Document",
                    ["SaveDocument"] = "Desar Document",
                    ["DeleteDocument"] = "Eliminar Document",
                    ["ExportToHtml"] = "Exportar a HTML",
                    ["UploadToGitHub"] = "Pujar a GitHub",
                    ["Search"] = "Cercar",
                    ["Language"] = "Idioma",
                    ["EditMode"] = "Editar",
                    ["PreviewMode"] = "Vista Pr√®via",
                    ["SplitMode"] = "Dividir",
                    ["VoiceRecognition"] = "Reconeixement de Veu",
                    ["Listening"] = "üé§ Escoltant... Parla ara",
                    ["VoiceRecognitionStopped"] = "üîá Reconeixement de veu aturat",
                    ["ReadingText"] = "üîä Llegint Text",
                    ["PlayingTextAloud"] = "Reproduint text en veu alta...",
                    ["Cancel"] = "Cancel¬∑lar",
                    ["Stop"] = "Aturar",
                    ["OK"] = "D'acord",
                    ["FocusModeActivated"] = "üéØ Mode Concentraci√≥ Activat",
                    ["FocusModeDeactivated"] = "üéØ Mode Concentraci√≥ Desactivat",
                    ["FocusModeDescription"] = "Interf√≠cie simplificada per a la concentraci√≥.\nPrem F11 per sortir.",
                    ["FocusModeRestored"] = "Interf√≠cie completa restaurada.",
                    ["Warning"] = "Advert√®ncia",
                    ["Success"] = "√àxit",
                    ["Error"] = "Error",
                    ["NoDocumentSelected"] = "Si us plau selecciona un document primer.",
                    ["FontSize"] = "üìè Mida de Lletra",
                    ["CurrentSize"] = "Mida actual: {0}pt",
                    ["PomodoroCompleted"] = "üçÖ Pomodoro Completat!",
                    ["PomodoroCompletedDescription"] = "Bona feina! Has completat una sessi√≥ de concentraci√≥ de 25 minuts.\n\n√âs hora d'un descans de 5 minuts?",
                    ["StartBreak"] = "Iniciar Descans",
                    ["ContinueWriting"] = "Continuar Escrivint",
                    ["Close"] = "Tancar",
                    ["AdvancedSearch"] = "Cerca Avan√ßada",
                    ["SearchFor"] = "Cercar:",
                    ["SearchIn"] = "Cercar a:",
                    ["CurrentDocument"] = "Document Actual",
                    ["AllDocuments"] = "Tots els Documents",
                    ["SelectedDocuments"] = "Documents Seleccionats",
                    ["UseRegularExpressions"] = "Usar expressions regulars",
                    ["WholeWordsOnly"] = "Nom√©s paraules completes",
                    ["FindAndReplace"] = "Cercar i Reempla√ßar",
                    ["Find"] = "Cercar:",
                    ["ReplaceWith"] = "Reempla√ßar amb:",
                    ["CaseSensitive"] = "Distingir maj√∫scules i min√∫scules",
                    ["ReplaceAll"] = "Reempla√ßar Tot",
                    ["FindNext"] = "Cercar Seg√ºent",
                    ["SearchResult"] = "üîç Resultat de Cerca",
                    ["FoundAtPosition"] = "Trobat a la posici√≥ {0}",
                    ["NotFound"] = "'{0}' no trobat",
                    ["ReplacementsCompleted"] = "Es van realitzar {0} reempla√ßaments",
                    ["DocumentStatistics"] = "üìä Estad√≠stiques del Document",
                    ["CompleteStatistics"] = "üìä Estad√≠stiques Completes",
                    ["Content"] = "üìù Contingut:",
                    ["Words"] = "‚Ä¢ Paraules: {0:N0}",
                    ["Characters"] = "‚Ä¢ Car√†cters: {0:N0}",
                    ["CharactersNoSpaces"] = "‚Ä¢ Car√†cters (sense espais): {0:N0}",
                    ["Lines"] = "‚Ä¢ L√≠nies: {0:N0}",
                    ["Paragraphs"] = "‚Ä¢ Par√†grafs: {0:N0}",
                    ["Sentences"] = "‚Ä¢ Frases: {0:N0}",
                    ["AvgWordsPerSentence"] = "‚Ä¢ Mitjana paraules/frase: {0}",
                    ["EstimatedTime"] = "‚è±Ô∏è Temps Estimat:",
                    ["ReadingTime"] = "‚Ä¢ Temps de lectura: ~{0} min",
                    ["SpeakingTime"] = "‚Ä¢ Temps d'orat√≤ria: ~{0} min",
                    ["SessionStats"] = "üìà Estad√≠stiques de Sessi√≥:",
                    ["WordsWrittenToday"] = "‚Ä¢ Paraules escrites avui: {0:N0}",
                    ["WordsInSession"] = "‚Ä¢ Paraules en aquesta sessi√≥: {0:N0}",
                    ["NoDocumentSelected"] = "Cap Document Seleccionat",
                    ["NoDocumentSelectedDescription"] = "Si us plau, selecciona o crea un document abans de pujar-lo a GitHub.",
                    ["Connected"] = "Connectat",
                    ["NotConnected"] = "No Connectat",
                    ["LanguageChanged"] = "Idioma canviat a {0}",
                    ["LastModified"] = "√öltima modificaci√≥",
                    ["DocumentIndex"] = "√çndex del Document",
                    ["WelcomeToJot"] = "Benvingut a Jot",
                    ["CreateFirstDocument"] = "Crea el teu primer document per comen√ßar",
                    ["CreateNewDocument"] = "Crear Nou Document",
                    ["GitHub"] = "GitHub",
                    ["ConnectGitHub"] = "Connectar GitHub",
                    ["UploadCurrent"] = "Pujar Actual",
                    ["Repositories"] = "Repositoris",
                    ["Disconnect"] = "Desconnectar",
                    ["ExpandGitHubOptions"] = "Expandir Opcions de GitHub",
                    ["DocumentTitle"] = "T√≠tol del document...",
                    ["SearchDocuments"] = "Cercar documents...",
                    ["WordsCount"] = "Paraules: {0}",
                    ["CharactersCount"] = "Car√†cters: {0}",
                    ["ReadingTimeCount"] = "Temps de lectura: {0} min",
                    ["LineColumn"] = "L√≠nia {0}, Columna {1}",
                    ["ExportingToHtml"] = "Exportant a HTML...",
                    ["ToggleSidebar"] = "Alternar Barra Lateral",
                    ["QuickUploadToGitHub"] = "Pujada R√†pida a GitHub",
                    ["GitHubSettings"] = "Configuraci√≥ de GitHub",
                    ["AIAssistant"] = "Assistent IA",
                    ["PythonCodeExecution"] = "Execuci√≥ de Codi Python",
                    ["Close"] = "Tancar",
                    ["Send"] = "Enviar",
                    ["EnterYourQuestion"] = "Escriu la teva pregunta...",
                    ["SuggestedQuestions"] = "Preguntes suggerides:",
                    ["ExportDocument"] = "Exportar a HTML",
                    ["DeleteDocument"] = "Eliminar",
                    ["UploadDocument"] = "Pujar a GitHub",
                    ["ChatbotWelcome"] = "Hola! S√≥c el teu assistent de documents. Pots preguntar-me sobre el contingut dels teus documents.",
                    ["SendEmail"] = "Enviar per Correu",
                    ["Send"] = "Enviar",
                    ["Cancel"] = "Cancel¬∑lar",
                    ["ToEmail"] = "Per a (Email)",
                    ["FromEmail"] = "De (Email)",
                    ["SendMethod"] = "M√®tode d'Enviament",
                    ["DefaultEmailClient"] = "Client de Correu Predeterminat",
                    ["CustomSMTP"] = "SMTP Personalitzat",
                    ["EmailFormat"] = "Format",
                    ["PlainText"] = "Text Pla",
                    ["Password"] = "Contrasenya",
                    ["SMTPServer"] = "Servidor SMTP",
                    ["EmailWarning"] = "Per a Gmail/Outlook, pot ser que necessitis activar 'Acc√©s d'apps menys segures' o fer servir una contrasenya d'aplicaci√≥.",
                    ["EmailSentSuccess"] = "Email enviat correctament!",
                    ["EmailSentError"] = "Error en enviar email. Si us plau verifica la teva configuraci√≥.",
                    ["EnterEmail"] = "Si us plau introdueix una adre√ßa d'email v√†lida.",
                    ["EmailClientOpened"] = "Client de correu obert correctament. Si us plau completa l'enviament des de la teva aplicaci√≥ de correu.",
                    ["EnterCredentials"] = "Si us plau introdueix les teves credencials d'email (correu i contrasenya).",
                    ["PrintDocument"] = "Imprimir Document",
                    ["PrintError"] = "Error en imprimir el document. Si us plau torna-ho a intentar.",

                    // üîÑ Historial de Versions
                    ["VersionHistory"] = "Historial de Versions",
                    ["Versions"] = "Versions",
                    ["Restore"] = "Restaurar",
                    ["Details"] = "Detalls",
                    ["Preview"] = "Vista Pr√®via",
                    ["CurrentVersion"] = "Versi√≥ actual",

                    // üîê Xifrat
                    ["EncryptDocument"] = "Xifrar Document",
                    ["UnlockDocument"] = "Desbloquejar Document",
                    ["ChangePassword"] = "Canviar Contrasenya",
                    ["Encrypt"] = "Xifrar",
                    ["Unlock"] = "Desbloquejar",
                    ["Change"] = "Canviar",
                    ["CurrentPassword"] = "Contrasenya Actual",
                    ["NewPassword"] = "Nova Contrasenya",
                    ["ConfirmPassword"] = "Confirmar Contrasenya",
                    ["PasswordsDoNotMatch"] = "Les contrasenyes no coincideixen",
                    ["EncryptDescription"] = "Protegeix el teu document amb una contrasenya segura. Usa xifratge AES-256.",
                    ["UnlockDescription"] = "Introdueix la teva contrasenya per desbloquejar i veure aquest document.",
                    ["ChangePasswordDescription"] = "Canvia la contrasenya de xifratge d'aquest document.",
                    ["EncryptionWarning"] = "‚ö†Ô∏è Recorda la teva contrasenya! No hi ha manera de recuperar-la si l'oblides.",
                    ["EncryptionError"] = "Error de xifratge. Verifica la teva contrasenya i torna-ho a intentar.",
                    ["LockDocument"] = "Bloquejar Document",

                    // ‚òÅÔ∏è Sincronitzaci√≥
                    ["CloudSync"] = "Sincronitzaci√≥ al N√∫vol",
                    ["CloudProvider"] = "Prove√Ødor de N√∫vol",
                    ["AutoSync"] = "Sincronitzaci√≥ Autom√†tica",
                    ["Enabled"] = "Activat",
                    ["Disabled"] = "Desactivat",
                    ["LastSync"] = "√öltima sincronitzaci√≥",
                    ["NeverSynced"] = "Mai sincronitzat",
                    ["SyncNow"] = "Sincronitzar Ara",
                    ["Syncing"] = "Sincronitzant...",
                    ["SelectProvider"] = "Selecciona un prove√Ødor de n√∫vol",
                    ["SyncSuccess"] = "Sincronitzat correctament",
                    ["SyncError"] = "Error de sincronitzaci√≥",
                    ["CloudSyncInfo"] = "El teu document se sincronitzar√† autom√†ticament amb el prove√Ødor de n√∫vol seleccionat.",

                    // üì∏ OCR
                    ["OCR"] = "OCR - Reconeixement de Text",
                    ["OCRDescription"] = "Extreu text d'imatges usant reconeixement √≤ptic de car√†cters.",
                    ["OCRLanguage"] = "Idioma OCR",
                    ["SelectImage"] = "Seleccionar Imatge",
                    ["FromClipboard"] = "Des del Porta-retalls",
                    ["ExtractedText"] = "Text Extret",
                    ["NoTextExtracted"] = "Encara no s'ha extret text...",
                    ["ExtractingText"] = "Extraient text...",
                    ["TextExtracted"] = "Text extret correctament",
                    ["NoImageInClipboard"] = "No hi ha imatge al porta-retalls",
                    ["NoTextFound"] = "No s'ha trobat text a la imatge",
                    ["InsertText"] = "Inserir Text",
                    ["Characters"] = "car√†cters",

                    // üîó Enlla√ßos
                    ["DocumentLinks"] = "Enlla√ßos del Document",
                    ["OutgoingLinks"] = "Enlla√ßos Sortints",
                    ["Backlinks"] = "Retroenlla√ßos",
                    ["RelatedDocuments"] = "Documents Relacionats",
                    ["BrokenLinks"] = "Enlla√ßos Trencats",
                    ["WikiLinkHelp"] = "Usa [[Nom Document]] per crear enlla√ßos entre documents",
                    ["NoLinksFound"] = "No s'han trobat enlla√ßos",
                    ["NoBacklinksFound"] = "No s'han trobat retroenlla√ßos",
                    ["NoRelatedFound"] = "No s'han trobat documents relacionats",
                    ["DocumentNotFound"] = "Document no trobat",
                    ["NoBrokenLinks"] = "No hi ha enlla√ßos trencats",

                    // üìé Adjunts
                    ["Attachments"] = "Fitxers Adjunts",
                    ["AddFile"] = "Afegir Fitxer",
                    ["PasteImage"] = "Enganxar Imatge",
                    ["SelectAttachment"] = "Selecciona un adjunt per previsualitzar",
                    ["NoAttachments"] = "Encara no hi ha adjunts",
                    ["OpenFile"] = "Obrir Fitxer",

                    // üîß Tooltips
                    ["TooltipNewDocument"] = "Nou Document",
                    ["TooltipSave"] = "Desar",
                    ["TooltipExportHTML"] = "Exportar a HTML",
                    ["TooltipPrint"] = "Imprimir Document",
                    ["TooltipPython"] = "Execuci√≥ de Codi Python",
                    ["TooltipGitHubUpload"] = "Pujada R√†pida a GitHub",
                    ["TooltipGitHubSettings"] = "Configuraci√≥ de GitHub",
                    ["TooltipLanguage"] = "Idioma / Language",
                    ["TooltipAIAssistant"] = "Assistent IA",
                    ["TooltipSendEmail"] = "Enviar per Correu",
                    ["TooltipVersionHistory"] = "Historial de Versions",
                    ["TooltipEncryption"] = "Xifrat",
                    ["TooltipCloudSync"] = "Sincronitzaci√≥ al N√∫vol",
                    ["TooltipOCR"] = "OCR - Reconeixement de Text",
                    ["TooltipDocumentLinks"] = "Enlla√ßos del Document",
                    ["TooltipAttachments"] = "Fitxers Adjunts"
                },
                ["ast"] = new Dictionary<string, string>
                {
                    ["AppTitle"] = "Jot - Toma de Notes Moderna",
                    ["Documents"] = "Documentos",
                    ["NewDocument"] = "Documentu Nuevu",
                    ["SaveDocument"] = "Guardar Documentu",
                    ["DeleteDocument"] = "Desaniciar Documentu",
                    ["ExportToHtml"] = "Esportar a HTML",
                    ["UploadToGitHub"] = "Xubir a GitHub",
                    ["Search"] = "Guetar",
                    ["Language"] = "Idioma",
                    ["EditMode"] = "Editar",
                    ["PreviewMode"] = "Vista Previa",
                    ["SplitMode"] = "Dividir",
                    ["VoiceRecognition"] = "Reconocimientu de Voz",
                    ["Listening"] = "üé§ Escuchando... Fala agora",
                    ["VoiceRecognitionStopped"] = "üîá Reconocimientu de voz par√°u",
                    ["ReadingText"] = "üîä Llevendo Testu",
                    ["PlayingTextAloud"] = "Reproduciendo testu en voz alta...",
                    ["Cancel"] = "Encaboxar",
                    ["Stop"] = "Parar",
                    ["OK"] = "Val",
                    ["FocusModeActivated"] = "üéØ Mou Concentraci√≥n Activ√°u",
                    ["FocusModeDeactivated"] = "üéØ Mou Concentraci√≥n Desactiv√°u",
                    ["FocusModeDescription"] = "Interfaz simplificada pa concentrase.\nPrimi F11 pa salir.",
                    ["FocusModeRestored"] = "Interfaz completa restaurada.",
                    ["Warning"] = "Alvertencia",
                    ["Success"] = "√âsitu",
                    ["Error"] = "Fallu",
                    ["NoDocumentSelected"] = "Por favor seleiciona un documentu primero.",
                    ["FontSize"] = "üìè Tama√±u de Lletra",
                    ["CurrentSize"] = "Tama√±u actual: {0}pt",
                    ["PomodoroCompleted"] = "üçÖ Pomodoro Complet√°u!",
                    ["PomodoroCompletedDescription"] = "¬°Bon trabayu! Completasti una sesi√≥n de concentraci√≥n de 25 minutos.\n\n¬øYe hora d'un descansu de 5 minutos?",
                    ["StartBreak"] = "Entamar Descansu",
                    ["ContinueWriting"] = "Siguir Escribiendo",
                    ["Close"] = "Zarrar",
                    ["AdvancedSearch"] = "Busca Avanzada",
                    ["SearchFor"] = "Guetar:",
                    ["SearchIn"] = "Guetar en:",
                    ["CurrentDocument"] = "Documentu Actual",
                    ["AllDocuments"] = "Tolos Documentos",
                    ["SelectedDocuments"] = "Documentos Escoy√≠os",
                    ["UseRegularExpressions"] = "Usar espresiones regulares",
                    ["WholeWordsOnly"] = "Nam√°i pallabres completes",
                    ["FindAndReplace"] = "Guetar y Trocar",
                    ["Find"] = "Guetar:",
                    ["ReplaceWith"] = "Trocar con:",
                    ["CaseSensitive"] = "Distinguir may√∫scules y min√∫scules",
                    ["ReplaceAll"] = "Trocar Too",
                    ["FindNext"] = "Guetar Siguiente",
                    ["SearchResult"] = "üîç Result√°u de Busca",
                    ["FoundAtPosition"] = "Atop√°u na posici√≥n {0}",
                    ["NotFound"] = "'{0}' non atop√°u",
                    ["ReplacementsCompleted"] = "Realiz√°ronse {0} trocamientos",
                    ["DocumentStatistics"] = "üìä Estad√≠stiques del Documentu",
                    ["CompleteStatistics"] = "üìä Estad√≠stiques Completes",
                    ["Content"] = "üìù Conten√≠u:",
                    ["Words"] = "‚Ä¢ Pallabres: {0:N0}",
                    ["Characters"] = "‚Ä¢ Carauteres: {0:N0}",
                    ["CharactersNoSpaces"] = "‚Ä¢ Carauteres (ensin espacios): {0:N0}",
                    ["Lines"] = "‚Ä¢ Llinies: {0:N0}",
                    ["Paragraphs"] = "‚Ä¢ P√°rrafos: {0:N0}",
                    ["Sentences"] = "‚Ä¢ Frases: {0:N0}",
                    ["AvgWordsPerSentence"] = "‚Ä¢ Promediu pallabres/frase: {0}",
                    ["EstimatedTime"] = "‚è±Ô∏è Tiempu Estim√°u:",
                    ["ReadingTime"] = "‚Ä¢ Tiempu de llectura: ~{0} min",
                    ["SpeakingTime"] = "‚Ä¢ Tiempu d'oratoria: ~{0} min",
                    ["SessionStats"] = "üìà Estad√≠stiques de Sesi√≥n:",
                    ["WordsWrittenToday"] = "‚Ä¢ Pallabres escrites g√ºei: {0:N0}",
                    ["WordsInSession"] = "‚Ä¢ Pallabres nesta sesi√≥n: {0:N0}",
                    ["NoDocumentSelected"] = "Deng√∫n Documentu Escoy√≠u",
                    ["NoDocumentSelectedDescription"] = "Por favor escueyi o cria un documentu enantes de xubilu a GitHub.",
                    ["Connected"] = "Coneut√°u",
                    ["NotConnected"] = "Non Coneut√°u",
                    ["LanguageChanged"] = "Idioma camud√°u a {0}",
                    ["LastModified"] = "√öltima modificaci√≥n",
                    ["DocumentIndex"] = "√çndiz del Documentu",
                    ["WelcomeToJot"] = "Bienlleg√°u a Jot",
                    ["CreateFirstDocument"] = "Cria'l to primer documentu p'entamar",
                    ["CreateNewDocument"] = "Criar Documentu Nuevu",
                    ["GitHub"] = "GitHub",
                    ["ConnectGitHub"] = "Coneutar GitHub",
                    ["UploadCurrent"] = "Xubir Actual",
                    ["Repositories"] = "Repositorios",
                    ["Disconnect"] = "Desconeutar",
                    ["ExpandGitHubOptions"] = "Espander Opciones de GitHub",
                    ["DocumentTitle"] = "T√≠tulu del documentu...",
                    ["SearchDocuments"] = "Guetar documentos...",
                    ["WordsCount"] = "Pallabres: {0}",
                    ["CharactersCount"] = "Carauteres: {0}",
                    ["ReadingTimeCount"] = "Tiempu de llectura: {0} min",
                    ["LineColumn"] = "Llinia {0}, Columna {1}",
                    ["ExportingToHtml"] = "Esportando a HTML...",
                    ["ToggleSidebar"] = "Alternar Barra Llateral",
                    ["QuickUploadToGitHub"] = "Xubida R√°pida a GitHub",
                    ["GitHubSettings"] = "Configuraci√≥n de GitHub",
                    ["AIAssistant"] = "Asistente IA",
                    ["PythonCodeExecution"] = "Execuci√≥n de C√≥digu Python",
                    ["Close"] = "Zarrar",
                    ["Send"] = "Unviar",
                    ["EnterYourQuestion"] = "Escribi la to entruga...",
                    ["SuggestedQuestions"] = "Entrugues suxer√≠es:",
                    ["ExportDocument"] = "Esportar a HTML",
                    ["DeleteDocument"] = "Desaniciar",
                    ["UploadDocument"] = "Xubir a GitHub",
                    ["ChatbotWelcome"] = "¬°Hola! Soi el to asistente de documentos. Pues entrugame sobro'l conten√≠u de los tos documentos.",
                    ["SendEmail"] = "Unviar per Correau",
                    ["Send"] = "Unviar",
                    ["Cancel"] = "Encaboxar",
                    ["ToEmail"] = "Pa (Email)",
                    ["FromEmail"] = "De (Email)",
                    ["SendMethod"] = "M√©todu d'Unviamientu",
                    ["DefaultEmailClient"] = "Cliente de Correau Predetermin√°u",
                    ["CustomSMTP"] = "SMTP Personaliz√°u",
                    ["EmailFormat"] = "Formatu",
                    ["PlainText"] = "Testu Planu",
                    ["Password"] = "Contrase√±a",
                    ["SMTPServer"] = "Servidor SMTP",
                    ["EmailWarning"] = "Pa Gmail/Outlook, quiciabes necesites activar 'Accesu d'apps menos segures' o usar una contrase√±a d'aplicaci√≥n.",
                    ["EmailSentSuccess"] = "¬°Email unvi√°u correchu!",
                    ["EmailSentError"] = "Fallu al unviar email. Por favor verifica la to configuraci√≥n.",
                    ["EnterEmail"] = "Por favor introduz una direici√≥n d'email v√°lida.",
                    ["EmailClientOpened"] = "Cliente de correau abiertu correchu. Por favor completa l'unviamientu dende la to aplicaci√≥n de correau.",
                    ["EnterCredentials"] = "Por favor introduz les tos credenciales d'email (correau y contrase√±a).",
                    ["PrintDocument"] = "Imprentar Documentu",
                    ["PrintError"] = "Fallu al imprentar el documentu. Por favor int√©ntalo otra vuelta.",

                    // üîÑ Historial de Versiones
                    ["VersionHistory"] = "Historial de Versiones",
                    ["Versions"] = "Versiones",
                    ["Restore"] = "Restaurar",
                    ["Details"] = "Detalles",
                    ["Preview"] = "Vista Previa",
                    ["CurrentVersion"] = "Versi√≥n actual",

                    // üîê Cifr√°u
                    ["EncryptDocument"] = "Cifrar Documentu",
                    ["UnlockDocument"] = "Desbloquiar Documentu",
                    ["ChangePassword"] = "Camudar Contrase√±a",
                    ["Encrypt"] = "Cifrar",
                    ["Unlock"] = "Desbloquiar",
                    ["Change"] = "Camudar",
                    ["CurrentPassword"] = "Contrase√±a Actual",
                    ["NewPassword"] = "Contrase√±a Nueva",
                    ["ConfirmPassword"] = "Confirmar Contrase√±a",
                    ["PasswordsDoNotMatch"] = "Les contrase√±es nun coinciden",
                    ["EncryptDescription"] = "Protexe'l to documentu con una contrase√±a segura. Usa cifr√°u AES-256.",
                    ["UnlockDescription"] = "Introduz la to contrase√±a pa desbloquiar y ver esti documentu.",
                    ["ChangePasswordDescription"] = "Camuda la contrase√±a de cifr√°u d'esti documentu.",
                    ["EncryptionWarning"] = "‚ö†Ô∏è ¬°Recuerda la to contrase√±a! Nun hai manera de recuperala si la escaeces.",
                    ["EncryptionError"] = "Fallu de cifr√°u. Verifica la to contrase√±a ya int√©ntalo otra vuelta.",
                    ["LockDocument"] = "Bloquiar Documentu",

                    // ‚òÅÔ∏è Sincronizaci√≥n
                    ["CloudSync"] = "Sincronizaci√≥n na √ëube",
                    ["CloudProvider"] = "Fornidor de √ëube",
                    ["AutoSync"] = "Sincronizaci√≥n Autom√°tica",
                    ["Enabled"] = "Activ√°u",
                    ["Disabled"] = "Desactiv√°u",
                    ["LastSync"] = "√öltima sincronizaci√≥n",
                    ["NeverSynced"] = "Enxam√°s sincroniz√°u",
                    ["SyncNow"] = "Sincronizar Agora",
                    ["Syncing"] = "Sincronizando...",
                    ["SelectProvider"] = "Escueyi un fornidor de √±ube",
                    ["SyncSuccess"] = "Sincroniz√°u correchu",
                    ["SyncError"] = "Fallu de sincronizaci√≥n",
                    ["CloudSyncInfo"] = "El to documentu sincronizar√°se autom√°ticamente col fornidor de √±ube escoy√≠u.",

                    // üì∏ OCR
                    ["OCR"] = "OCR - Reconocimientu de Testu",
                    ["OCRDescription"] = "Estrayi testu d'im√°xenes usando reconocimientu √≥pticu de carauteres.",
                    ["OCRLanguage"] = "Idioma OCR",
                    ["SelectImage"] = "Esbillar Imaxe",
                    ["FromClipboard"] = "Dende'l Porta-retayos",
                    ["ExtractedText"] = "Testu Estray√≠u",
                    ["NoTextExtracted"] = "Ent√° nun s'estray√≥ testu...",
                    ["ExtractingText"] = "Estrayendo testu...",
                    ["TextExtracted"] = "Testu estray√≠u correchu",
                    ["NoImageInClipboard"] = "Nun hai imaxe nel porta-retayos",
                    ["NoTextFound"] = "Nun s'atop√≥ testu na imaxe",
                    ["InsertText"] = "Inxertar Testu",
                    ["Characters"] = "carauteres",

                    // üîó Enllaces
                    ["DocumentLinks"] = "Enllaces del Documentu",
                    ["OutgoingLinks"] = "Enllaces Salientes",
                    ["Backlinks"] = "Retroenlaces",
                    ["RelatedDocuments"] = "Documentos Rellacionaos",
                    ["BrokenLinks"] = "Enllaces Rotos",
                    ["WikiLinkHelp"] = "Usa [[Nome Documentu]] pa criar enllaces ente documentos",
                    ["NoLinksFound"] = "Nun s'atoparon enllaces",
                    ["NoBacklinksFound"] = "Nun s'atoparon retroenlaces",
                    ["NoRelatedFound"] = "Nun s'atoparon documentos rellacionaos",
                    ["DocumentNotFound"] = "Documentu nun atop√°u",
                    ["NoBrokenLinks"] = "Nun hai enllaces rotos",

                    // üìé Axuntos
                    ["Attachments"] = "Ficheros Axuntos",
                    ["AddFile"] = "Amestar Ficheru",
                    ["PasteImage"] = "Apegar Imaxe",
                    ["SelectAttachment"] = "Escueyi un axuntu pa previsualizar",
                    ["NoAttachments"] = "Ent√° nun hai axuntos",
                    ["OpenFile"] = "Abrir Ficheru",

                    // üîß Tooltips
                    ["TooltipNewDocument"] = "Documentu Nuevu",
                    ["TooltipSave"] = "Guardar",
                    ["TooltipExportHTML"] = "Esportar a HTML",
                    ["TooltipPrint"] = "Imprentar Documentu",
                    ["TooltipPython"] = "Execuci√≥n de C√≥digu Python",
                    ["TooltipGitHubUpload"] = "Xubida R√°pida a GitHub",
                    ["TooltipGitHubSettings"] = "Configuraci√≥n de GitHub",
                    ["TooltipLanguage"] = "Idioma / Language",
                    ["TooltipAIAssistant"] = "Asistente IA",
                    ["TooltipSendEmail"] = "Unviar per Correau",
                    ["TooltipVersionHistory"] = "Historial de Versiones",
                    ["TooltipEncryption"] = "Cifr√°u",
                    ["TooltipCloudSync"] = "Sincronizaci√≥n na √ëube",
                    ["TooltipOCR"] = "OCR - Reconocimientu de Testu",
                    ["TooltipDocumentLinks"] = "Enllaces del Documentu",
                    ["TooltipAttachments"] = "Ficheros Axuntos"
                }
            };
        }

        public void SetLanguage(string languageCode)
        {
            try
            {
                if (!_supportedLanguages.ContainsKey(languageCode))
                {
                    languageCode = "en";
                }

                CurrentLanguage = languageCode;

                // Notificar cambio global para forzar actualizaci√≥n de todas las propiedades
                PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(string.Empty));

                // Notificar cambios espec√≠ficos
                PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(nameof(CurrentLanguage)));
                PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(nameof(CurrentLanguageName)));

                System.Diagnostics.Debug.WriteLine($"Language changed to: {languageCode} ({CurrentLanguageName})");
            }
            catch (Exception ex)
            {
                System.Diagnostics.Debug.WriteLine($"Error setting language: {ex.Message}");
            }
        }

        public string GetString(string key)
        {
            try
            {
                if (_localizedStrings != null && 
                    _localizedStrings.TryGetValue(CurrentLanguage, out var languageDict) &&
                    languageDict.TryGetValue(key, out var value))
                {
                    return value;
                }

                // Fallback a ingl√©s si no se encuentra en el idioma actual
                if (_localizedStrings != null && 
                    _localizedStrings.TryGetValue("en", out var englishDict) &&
                    englishDict.TryGetValue(key, out var englishValue))
                {
                    return englishValue;
                }

                return key;
            }
            catch (Exception ex)
            {
                System.Diagnostics.Debug.WriteLine($"Error getting string for key '{key}': {ex.Message}");
                return key;
            }
        }

        public string GetString(string key, params object[] args)
        {
            try
            {
                var format = GetString(key);
                return string.Format(format, args);
            }
            catch (Exception ex)
            {
                System.Diagnostics.Debug.WriteLine($"Error formatting string for key '{key}': {ex.Message}");
                return key;
            }
        }
    }
}